#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language italian
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 5
\tocdepth 5
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Section
Modifiche alla procedura standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Modifiche-alla-procedura"

\end_inset


\end_layout

\begin_layout Standard
In questa sezione potrete trovare tutte le procedure che esulano dall'installazi
one standard, aggiungendo delle ulteriori features o che permettono di 
\begin_inset Quotes eld
\end_inset

semplificare la vita
\begin_inset Quotes erd
\end_inset

 nel post-installazione.
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
E' inteso che, ove non specificato, si debba seguire 
\begin_inset Quotes eld
\end_inset

passo-passo
\begin_inset Quotes erd
\end_inset

 la procedura descritta
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Istanze multiple di LQFB nello stesso server
\end_layout

\begin_layout Standard
Recentemente ci siamo trovati nella condizione di dover avere più istanze
 di LQFB all'interno dello stesso server di produzione con le caratteristiche
 descritte nel Capitolo 2.
 Per questo motivo abbiamo dovuto effettuare le seguenti modifiche al server
 stesso:
\end_layout

\begin_layout Itemize
Cambiare MTA da 
\emph on
Ssmtp
\emph default
 a 
\emph on
Msmtp
\end_layout

\begin_layout Itemize
Configurare Apache affinchè usi un utente differente da 
\emph on
www-data
\emph default
 per ogni istanza di LQFB
\end_layout

\begin_layout Itemize
Impostare, per ogni nuovo utente creato a questo scopo, la mail utilizzata
 da LQFB
\end_layout

\begin_layout Subsubsection
Installazione pacchetti necessari
\end_layout

\begin_layout Standard
I pacchetti che si dovranno installare sono:
\end_layout

\begin_layout Itemize
Msmtp
\end_layout

\begin_layout Itemize
apache2-mpm-itk
\end_layout

\begin_layout Standard
E si dovrà rimuovere il pacchetto 
\series bold
Ssmtp
\series default

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Nel caso fosse installato questo
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Per Debian:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset listings
lstparams "breaklines=true,language=bash"
inline false
status open

\begin_layout Plain Layout

#apt-get -y purge ssmtp && apt-get -y install msmtp apache2-mpm-itk
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Creazione utente e configurazione Apache
\end_layout

\begin_layout Standard
La libreria per Apache che abbiamo appena installato permette l'uso di una
 nuova istruzione all'interno del VirtualHost:
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{center}
\end_layout

\end_inset


\series bold
AssignUserId [user] [group]
\series default

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{center}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Questa istruzione permette ad Apache di far girare un sito internet non
 più come 
\emph on
www-data
\emph default
, ovvero l'utente creato di default da Apache, ma come l'utente e gruppo
 definiti nell'istruzione.
 Ci sarà utile in quanto 
\series bold
Msmtp
\series default
 andrà a cercare le impostazioni del server SMTP a cui connettersi all'interno
 della home di un utente.
 Facendo ciò potremo forzare Apache a far girare ogni istanza di LQFB con
 un utente differente, creare per ogni utente un file di impostazioni di
 Msmtp e, quindi, a seconda dell'istanza di LQFB che si usa, chiamare il
 server SMTP corretto.
\end_layout

\begin_layout Standard
Per questo motivo, dovremo creare un nuovo utente per ogni istanza di LQFB
 che si vorrà configurare.
 
\end_layout

\begin_layout Standard
Usiamo il seguente comando:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset listings
lstparams "breaklines=true,language=bash"
inline false
status open

\begin_layout Plain Layout

# adduser --disabled-login lqfb-xxxx
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Con il seguente comando creeremo un utente chiamato 
\emph on
lqfb-xxxx
\emph default
, con la sua home in 
\emph on
/home/lqfb-xxxx
\begin_inset Foot
status open

\begin_layout Plain Layout
Nel caso vogliate modificare la sua home, basterà usare
\end_layout

\end_inset


\emph default
 e non verrà chiesto di inserire una password per quell'utente
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
D'altro canto quest'utente serve solo per poter avere il suo file di configurazi
oni di Msmtp, quindi non vogliamo che qualcuno possa usarlo per avere un
 accesso al server
\end_layout

\end_inset

.
\end_layout

\end_body
\end_document
